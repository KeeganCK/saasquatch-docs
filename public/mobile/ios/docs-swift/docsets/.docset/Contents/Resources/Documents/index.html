<!DOCTYPE html>
<html lang="en">
  <head>
    <title>  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html"> Docs</a> (100% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html"> Reference</a>
        <img id="carat" src="img/carat.png" />
          Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Saasquatch.html">Saasquatch</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#quickstart_guide' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='quickstart_guide'>Quickstart Guide</h1>

<p>The Referral SaaSquatch iOS SDK integrates a referral program into your iOS app. </p>

<p>We&rsquo;re going to add the SDK into our project and start using it to interface with Referral SaaSquatch.</p>

<p>For a working demo implementation, check out our <a href="https://github.com/saasquatch/mobile-sdk-ios-sample" title="Sample App">Sample App</a>.</p>
<a href='#installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='installation'>Installation</h2>

<p>The deployment target for this SDK is 8.0.</p>

<p>The SDK can be installed with CocoaPods or by manually including and linking the framework.</p>
<a href='#cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='cocoapods'>CocoaPods</h3>

<p>If you do not have CocoaPods installed on your system, get it with:</p>

<p><code>$ sudo gem install cocoapods</code></p>

<p>To install the SDK using CocoaPods first navigate to your project directory:</p>

<p><code>$ cd /path/to/my/project</code></p>

<p>Then run <code>$ pod init</code> to setup CocoaPods for your project.</p>

<p>Open your newly created <code>Podfile</code>. Add the following to your target(s):</p>
<pre class="highlight ruby"><code><span class="n">target</span> <span class="s1">'SampleApp'</span> <span class="k">do</span>
  <span class="n">pod</span> <span class="s1">'saasquath-sdk-swift'</span><span class="p">,</span> <span class="s1">'~&gt; 1.0.0'</span>
<span class="k">end</span>
</code></pre>

<p>Make sure you uncomment the line:</p>

<p><code>use_frameworks!</code></p>

<p>Save and close the Podfile and run <code>$ pod install</code>. The SDK will be integrated in your project. If there was no workspace one will be created. Please use the new <code>.xcworkspace</code> from now on.</p>

<p>The SDK is now available for use. Please see <a href="#usage">Usage</a> for usage instructions.</p>
<a href='#manual_installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='manual_installation'>Manual Installation</h3>

<p>There are 2 steps to install the SDK in your app:</p>

<ul>
<li>Add the SDK to your project.</li>
<li>Link the library.</li>
</ul>
<a href='#step_1_add_the_sdk_to_your_project' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='step_1_add_the_sdk_to_your_project'>Step 1: Add the SDK to your project</h4>

<p>Unzip the SDK and drag <code>saasquatch.framework</code> into your XCode project.
Make sure you add it to your app targets.</p>
<a href='#step_2_link_the_library' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='step_2_link_the_library'>Step 2: Link the library</h4>

<p>Select your project in the Project navigator like this:</p>

<p><img src="https://raw.githubusercontent.com/saasquatch/mobile-sdk-swift-cocoapod/master/ios_sdk_screen3.png"></img></p>

<p>Make sure to select <q>Copy items if needed</q> and add the framework to your app&rsquo;s target:</p>

<p><img src="https://raw.githubusercontent.com/saasquatch/mobile-sdk-swift-cocoapod/master/ios_sdk_screen4.png" alt="Add framework screenshot" title="Your options should look like this"></p>

<p>Under the <strong>General</strong> tab scroll down to <strong>Embedded Binaries</strong>.
Click the + icon and add <code>saasquatch.framework</code>.
Make sure <code>saasquatch.framework</code> is also listed under <strong>Linked Frameworks and Libraries</strong>.</p>

<p>It should look like this:</p>

<p><img src="https://raw.githubusercontent.com/saasquatch/mobile-sdk-swift-cocoapod/master/ios_sdk_screen1.png" alt="General tab screenshot" title="Your General tab should look like this"></p>

<p>Next, head to the <strong>Build Phases</strong> tab.
If it is not already listed under <strong>Link Binary With Libraries</strong> and <strong>Embed Frameworkds</strong>, add it now.</p>

<p>Your <strong>Build Phases</strong> tab should look like this:</p>

<p><img src="https://raw.githubusercontent.com/saasquatch/mobile-sdk-swift-cocoapod/master/ios_sdk_screen2.png" alt="Build Phases tab screenshot" title="Your Build Phases tab should look like this"></p>

<p>The SDK is now ready for use in your project.</p>
<a href='#usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='usage'>Usage</h2>

<p>The Referral SaaSquatch iOS SDK allows us to:</p>

<ul>
<li>Register our users with Referral SaaSquatch to track their referrals.</li>
<li>Track our user&rsquo;s referrals with Referral SaaSquatch.</li>
<li>Fetch information about our users, referral codes and rewards.</li>
</ul>

<p>To demonstrate how to use the SDK, let&rsquo;s walk through registering a user with Referral SaaSquatch and making a referral as demoed in our <a href="https://github.com/saasquatch/mobile-sdk-ios-sample" title="Sample App">Sample App</a>. This can be achieved by following these steps:</p>

<ul>
<li>Register our new user with Referral SaaSquatch.</li>
<li>Lookup a referral code provided by our user during sign up.</li>
<li>Apply the referral to our user&rsquo;s account.</li>
<li>Show our user some information about the user who referred them.</li>
</ul>
<a href='#import_saasquatch' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='import_saasquatch'>Import Saasquatch</h4>

<p>Import the Saasquatch class at the top of your file.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="n">saasquatch</span>
</code></pre>
<a href='#register_a_user_with_referral_saasquatch' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='register_a_user_with_referral_saasquatch'>Register a user with Referral SaaSquatch</h4>

<p>To register a user, we provide user information to Referral SaaSquatch. We provide our tenant alias which identifies our app. A userId from our system is passed to SaaSquatch to uniquely identify our users. We pass in an accountId, which Referral SaaSquatch uses to group users together; see <a href="http://docs.referralsaasquatch.com/shared-vs-solo-accounts/" title="Shared vs Solo Accounts">Shared vs Solo Accounts</a> to see what you should use here.
Lastly, we provide a valid JSON object containing information about our user. For a description of the available <code>userInfo</code> fields, please see <a href="http://docs.referralsaasquatch.com/api/methods/#open_create_user" title="Referral SaaSquatch REST API reference">SaaSquatch docs</a>. Here is an example:</p>
<pre class="highlight swift"><code><span class="c1">// This is your tenant alias which identifies you with Referral SaaSquatch</span>
<span class="k">let</span> <span class="nv">tenant</span> <span class="o">=</span> <span class="s">"acpiocfij942"</span>

<span class="c1">// We register our user internally, then pass the user's information to Referral SaaSquatch</span>
<span class="k">let</span> <span class="nv">userId</span> <span class="o">=</span> <span class="s">"000001"</span>
<span class="k">let</span> <span class="nv">accountId</span> <span class="o">=</span> <span class="s">"000001"</span>
<span class="k">let</span> <span class="nv">secret</span> <span class="o">=</span> <span class="kt">NSUUID</span><span class="p">()</span><span class="o">.</span><span class="kt">UUIDString</span>

<span class="k">let</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"secret"</span><span class="p">:</span> <span class="n">secret</span><span class="p">,</span>
    <span class="s">"id"</span><span class="p">:</span> <span class="n">userId</span><span class="p">,</span>
    <span class="s">"accountId"</span><span class="p">:</span> <span class="n">accountId</span><span class="p">,</span>
    <span class="s">"email"</span><span class="p">:</span> <span class="s">"claire@lallybroch.com"</span><span class="p">,</span>
    <span class="s">"firstName"</span><span class="p">:</span> <span class="s">"Claire"</span><span class="p">,</span>
    <span class="s">"lastName"</span><span class="p">:</span> <span class="s">"Fraser"</span><span class="p">,</span>
    <span class="s">"locale"</span><span class="p">:</span> <span class="s">"en_US"</span><span class="p">,</span>
    <span class="s">"referralCode"</span><span class="p">:</span> <span class="s">"CLAIREFRASER"</span><span class="p">]</span>
</code></pre>

<p>In this example, we assign an id of 000001 since Claire is our first user. We pass her email, first and last names, and her locale to Referral SaaSquatch. We have also assigned her a referral code so she can use it to refer new users. When a new user signs up with referral code <q>CLAIREFRASER</q> she will get the credit.</p>

<p><strong>Important:</strong> The secret is a unique string which authenticates your user. Consider this your password for accessing the user&rsquo;s information. It should not contain any sensitive user information. Here, I am generating UUIDs for use as secret. Remember to save the secret so you can use it later, or else you will not be able to authenticate requests.</p>

<p>Now we can register our user with Referral SaaSquatch using this call: </p>
<pre class="highlight swift"><code>
<span class="c1">// Register a user with Referral Saasquatch</span>
<span class="kt">Saasquatch</span><span class="o">.</span><span class="nf">registerUserForTenant</span><span class="p">(</span><span class="n">tenant</span><span class="p">,</span> <span class="nv">withUserID</span><span class="p">:</span> <span class="n">userId</span><span class="p">,</span> <span class="nv">withAccountID</span><span class="p">:</span> <span class="n">accountId</span><span class="p">,</span> <span class="nv">withUserInfo</span><span class="p">:</span> <span class="n">userInfo</span><span class="p">,</span>
    <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

        <span class="c1">// Code to be executed after the async call returns</span>
<span class="p">})</span>

</code></pre>

<p>We provide a <code>completionHandler</code> which will be called with <code>userInfo</code> and <code>error</code>. <code>userInfo</code> contains the returned information about the user. <code>error</code> contains a description of the error, if any, and an error code indicating the HTTP status code returned by the server. If <code>error</code> is nil then <code>userInfo</code> will exist and vice versa.</p>

<p>In our completionHandler, we will parse through the returned data and save anything useful for later. </p>
<pre class="highlight swift"><code><span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

    <span class="c1">// First, check if an error occurred</span>
    <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="c1">// If the error is an http error, the error code will be an http status code</span>
        <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"401 Unauthorized"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">400</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"400 Bad Request"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// We can get a description of the error with:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="o">!.</span><span class="n">localizedDescription</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="c1">// We would like to save the share links returned by the Referral SaaSquatch server.</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">shareLinks</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">?[</span><span class="s">"shareLinks"</span><span class="p">]</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">],</span>
        <span class="k">let</span> <span class="nv">shareLink</span> <span class="o">=</span> <span class="n">shareLinks</span><span class="p">[</span><span class="s">"shareLink"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
        <span class="k">let</span> <span class="nv">facebookShareLink</span> <span class="o">=</span> <span class="n">shareLinks</span><span class="p">[</span><span class="s">"mobileFacebookShareLink"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
        <span class="k">let</span> <span class="nv">twitterShareLink</span> <span class="o">=</span> <span class="n">shareLinks</span><span class="p">[</span><span class="s">"mobileTwitterShareLink"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<a href='#make_the_referral' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='make_the_referral'>Make the referral</h4>

<p>Once the user is registered and any useful information returned in <code>userInfo</code> has been saved away, we will make their referral with Referral SaaSquatch. We&rsquo;ll call <code>applyReferralCode</code> with the code our user gave us and their userId, accountId and secret. The function validates the referral code. If the code is successful the reward information will be returned in <code>userInfo</code>, or if the code cannot be applied to the account an error will be returned.</p>
<pre class="highlight swift"><code><span class="kt">Saasquatch</span><span class="o">.</span><span class="nf">applyReferralCode</span><span class="p">(</span><span class="s">"BOBTESTERSON"</span><span class="p">,</span> <span class="nv">forTenant</span><span class="p">:</span> <span class="n">tenant</span><span class="p">,</span> <span class="nv">toUserID</span><span class="p">:</span> <span class="n">userId</span><span class="p">,</span> <span class="nv">toAccountID</span><span class="p">:</span> <span class="n">accountId</span><span class="p">,</span> <span class="nv">withSecret</span><span class="p">:</span> <span class="n">secret</span><span class="p">,</span>
    <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

        <span class="c1">// First, make sure there is no error</span>
        <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="p">{</span>
                <span class="c1">// The secret was not the same as registered</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Bad secret"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">404</span> <span class="p">{</span>
                <span class="c1">// The referral code was not found</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Bad referral code"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="o">!.</span><span class="n">localizedDescription</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// Parse the referral code information returned in userInfo</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">reward</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">?[</span><span class="s">"reward"</span><span class="p">]</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">],</span>
        <span class="k">let</span> <span class="nv">type</span> <span class="o">=</span> <span class="n">reward</span><span class="p">[</span><span class="s">"type"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// For a complete list of reward types and fields, please visit http://docs.referralsaasquatch.com/api/methods/#open_apply_code</span>
        <span class="k">if</span> <span class="n">type</span> <span class="o">==</span> <span class="s">"PCT_DISCOUNT"</span> <span class="p">{</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">percent</span> <span class="o">=</span> <span class="n">reward</span><span class="p">[</span><span class="s">"discountPercent"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Int</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Do something with the reward</span>
    <span class="p">})</span>
</code></pre>

<p>During your user&rsquo;s registration, you may want to look up a referral code they entered to check it&rsquo;s existance and get information about the associated reward. The call is very similar to <code>applyReferralCode</code> and returns the same reward information in <code>userInfo</code>. The tenant and referral code are the only required parameters, but if you make too many calls without a secret you may get a 401: Unauthorized response. For a complete description of the available fields, visit the <a href="http://docs.referralsaasquatch.com/api/methods/#open_apply_code" title="Referral SaaSquatch REST API reference">SaaSquatch docs</a>.</p>
<pre class="highlight swift"><code><span class="kt">Saasquatch</span><span class="o">.</span><span class="nf">lookupReferralCode</span><span class="p">(</span><span class="s">"BOBTESTERSON"</span><span class="p">,</span> <span class="nv">forTenant</span><span class="p">:</span> <span class="n">tenant</span><span class="p">,</span> <span class="nv">withSecret</span><span class="p">:</span> <span class="n">secret</span><span class="p">,</span>
    <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

        <span class="c1">// Parse the reward as in applyReferralCode(_:forTenant:toUserID:toAccountID:withSecret:completionHandler)</span>

    <span class="p">})</span>
</code></pre>
<a href='#lookup_who_referred_our_new_user' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='lookup_who_referred_our_new_user'>Lookup who referred our new user</h4>

<p>The last thing we would like to do is let our user know they have been referred successfully. Let&rsquo;s lookup the user that referred them so we can let our user know who they can thank. For this, we can use the <code>userByReferralCode</code> method like this:</p>
<pre class="highlight swift"><code><span class="kt">Saasquatch</span><span class="o">.</span><span class="nf">userByReferralCode</span><span class="p">(</span><span class="s">"BOBTESTERSON"</span><span class="p">,</span> <span class="nv">forTenant</span><span class="p">:</span> <span class="n">tenant</span><span class="p">,</span> <span class="nv">withSecret</span><span class="p">:</span> <span class="n">secret</span><span class="p">,</span>
    <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

        <span class="c1">// Always check the error</span>
        <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="p">{</span>
                <span class="c1">// The secret was not the same as registered</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Bad secret"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">404</span> <span class="p">{</span>
                <span class="c1">// The user associated with the referral code was not found</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Not found"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="o">!.</span><span class="n">localizedDescription</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// Parse the returned information</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">referrerFirstName</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">?[</span><span class="s">"firstName"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">referrerLastInitial</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">?[</span><span class="s">"lastInitial"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">referrerImageURL</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">?[</span><span class="s">"imageUrl"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// Now we can use this information to inform our user of their referral</span>
    <span class="p">})</span>
</code></pre>

<p>Great! We registered our new user with Referral SaaSquatch and successfully made a referral.</p>
<a href='#list_referrals' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='list_referrals'>List Referrals</h4>

<p>Let&rsquo;s add one more bit of functionality to our app to demonstrate <code>listReferralsForTenant</code>. Bob Testerson referred our new user, Claire Fraser, and we would like to show him a list of everyone he&rsquo;s referred (it&rsquo;s a lot). To do this, we call <code>listReferralsForTenant</code>.</p>

<p>This method looks up all the referrals for us, the tenant. The other required parameter is a secret to authenticate the request. The remainder of the parameters are options for filtering this list. In this case, we want to list only the referrals where Bob is the <em>referrer</em>. We will pass in Bob&rsquo;s userId and accountId and parse the list returned in <code>userInfo</code>. For a description of the options for filtering, see the <a href="http://docs.referralsaasquatch.com/api/methods/#open_list_referrals" title="Referral SaaSquatch REST API reference">SaaSquatch
docs</a>.</p>
<pre class="highlight swift"><code><span class="kt">Saasquatch</span><span class="o">.</span><span class="nf">listReferralsForTenant</span><span class="p">(</span><span class="n">tenant</span><span class="p">,</span> <span class="nv">withSecret</span><span class="p">:</span> <span class="n">secret</span><span class="p">,</span> <span class="nv">forReferringAccountID</span><span class="p">:</span> <span class="n">bobsAccountId</span><span class="p">,</span> <span class="nv">forReferringUserID</span><span class="p">:</span> <span class="n">bobsUserId</span><span class="p">,</span> <span class="nv">beforeDateReferralPaid</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">beforeDateReferralEnded</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">withReferredModerationStatus</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">withReferrerModerationStatus</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">withLimit</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">withOffset</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
    <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{(</span><span class="nv">userInfo</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="k">in</span>

        <span class="c1">// Check the error</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="p">{</span>
                <span class="c1">// The secret was not the same as registered</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Bad secret"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">404</span> <span class="p">{</span>
                <span class="c1">// The tenant does not exist</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Bad tenant"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="o">!.</span><span class="n">localizedDescription</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="c1">// Parse the list of referrals</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">referrals</span><span class="p">:</span> <span class="kt">NSArray</span> <span class="o">=</span> <span class="n">userInfo</span><span class="o">!</span><span class="p">[</span><span class="s">"referrals"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSArray</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">referral</span> <span class="k">in</span> <span class="n">referrals</span> <span class="p">{</span>

            <span class="k">guard</span> <span class="k">let</span> <span class="nv">referredUser</span> <span class="o">=</span> <span class="n">referral</span><span class="p">[</span><span class="s">"referredUser"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSDictionary</span><span class="p">,</span>
                <span class="k">let</span> <span class="nv">firstName</span> <span class="o">=</span> <span class="n">referredUser</span><span class="p">[</span><span class="s">"firstName"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span><span class="p">,</span>
                <span class="k">let</span> <span class="nv">referredReward</span> <span class="o">=</span> <span class="n">referral</span><span class="p">[</span><span class="s">"referredReward"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSDictionary</span><span class="p">,</span>

                <span class="c1">// In this case, we are giving out only percent discount rewards, so we know this field will exist</span>
                <span class="k">let</span> <span class="nv">discountPercent</span> <span class="o">=</span> <span class="n">referredReward</span><span class="p">[</span><span class="s">"discountPercent"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSInteger</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">break</span>
                <span class="p">}</span>

            <span class="c1">// Do something with the referral information</span>
        <span class="p">}</span>
    <span class="p">})</span>
</code></pre>
<a href='#done' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='done'>Done!</h4>

<p>For a working demo implementation, check out our <a href="https://github.com/saasquatch/mobile-sdk-ios-sample" title="Sample App">Sample App</a>.</p>

<p>For a detailed description of the <code>Saasquatch</code> class and it&rsquo;s public methods, please visit the API level docs (TODO: LINK THE DOCS).</p>

<p>For a reference of the fields available in <code>userInfo</code> please visit the <a href="http://docs.referralsaasquatch.com/api/methods/" title="Referral SaaSquatch REST API docs">SaaSquatch Docs</a>,</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2016 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2016-04-29)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.6.0</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
